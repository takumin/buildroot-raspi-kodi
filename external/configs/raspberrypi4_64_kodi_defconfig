# Mirrors
BR2_DL_DIR="$(DL_DIR)"
BR2_KERNEL_MIRROR="https://ftp.jaist.ac.jp/pub/Linux/kernel.org"
BR2_GNU_MIRROR="https://ftp.jaist.ac.jp/pub/GNU"
BR2_CPAN_MIRROR="https://ftp.jaist.ac.jp/pub/CPAN"

# Toolchain
BR2_TOOLCHAIN=y
BR2_TOOLCHAIN_EXTERNAL=y
BR2_TOOLCHAIN_EXTERNAL_PREINSTALLED=y
BR2_TOOLCHAIN_EXTERNAL_ARM_AARCH64=y
BR2_TOOLCHAIN_EXTERNAL_PATH="/opt/gcc-aarch64-none-linux-gnu"

# Ccache
BR2_CCACHE=y
BR2_CCACHE_DIR="$(CCACHE_DIR)"
BR2_CCACHE_INITIAL_SETUP="--max-size 8G"

# Disable build-id
BR2_REPRODUCIBLE=y

# Architecture
BR2_aarch64=y
BR2_cortex_a72=y
BR2_ARM_FPU_VFPV4=y

# System
BR2_INIT_SYSTEMD=y
BR2_SYSTEM_DHCP="eth0"
BR2_SYSTEM_DEFAULT_PATH="/bin:/sbin:/usr/bin:/usr/sbin"
BR2_TARGET_ENABLE_ROOT_LOGIN=y
BR2_TARGET_GENERIC_ROOT_PASSWD="root"
BR2_TARGET_GENERIC_PASSWD_SHA512=y
BR2_TARGET_GENERIC_GETTY_PORT="tty1"
BR2_TARGET_TZ_INFO=y
BR2_TARGET_TZ_ZONELIST="default"
BR2_TARGET_LOCALTIME="Etc/UTC"
BR2_ROOTFS_OVERLAY="$(BR2_EXTERNAL_RASPI_PATH)/overlay"
BR2_ROOTFS_USERS_TABLES="$(BR2_EXTERNAL_RASPI_PATH)/board/users-tables.txt"
BR2_ROOTFS_POST_FAKEROOT_SCRIPT="$(BR2_EXTERNAL_RASPI_PATH)/board/post-fakeroot.sh"
BR2_ROOTFS_POST_IMAGE_SCRIPT="$(BR2_EXTERNAL_RASPI_PATH)/board/post-image.sh"

# Linux headers same as kernel, a 5.10 series
BR2_PACKAGE_HOST_LINUX_HEADERS_CUSTOM_5_10=y

# Kernel
BR2_LINUX_KERNEL=y
BR2_LINUX_KERNEL_CUSTOM_TARBALL=y
BR2_LINUX_KERNEL_CUSTOM_TARBALL_LOCATION="$(call github,raspberrypi,linux,24c8b0546a820222a1ebcfe606dfacb0e228c466)/linux-24c8b0546a820222a1ebcfe606dfacb0e228c466.tar.gz"
BR2_LINUX_KERNEL_DEFCONFIG="bcm2711"

# Build the DTB from the kernel sources
BR2_LINUX_KERNEL_DTS_SUPPORT=y
BR2_LINUX_KERNEL_DTB_OVERLAY_SUPPORT=y
BR2_LINUX_KERNEL_INTREE_DTS_NAME="broadcom/bcm2711-rpi-4-b"

# Kernel Compression
BR2_LINUX_KERNEL_ZSTD=y

# Required Host OpenSSL Package
BR2_LINUX_KERNEL_NEEDS_HOST_OPENSSL=y

# Required Host Zstandard Package
BR2_PACKAGE_HOST_KMOD=y
BR2_PACKAGE_HOST_KMOD_ZSTD=y

# Bootloader
BR2_TARGET_UBOOT=y
BR2_TARGET_UBOOT_NEEDS_OPENSSL=y
BR2_TARGET_UBOOT_BOARD_DEFCONFIG="rpi_4"
BR2_TARGET_UBOOT_CONFIG_FRAGMENT_FILES="$(BR2_EXTERNAL_RASPI_PATH)/board/u-boot.config.fragment"

# Initramfs
BR2_TARGET_ROOTFS_CPIO=y
BR2_TARGET_ROOTFS_CPIO_ZSTD=y

# Disable tarball rootfs
BR2_TARGET_ROOTFS_TAR=n

# Raspberry Pi Firmware
BR2_PACKAGE_RPI_FIRMWARE=y
BR2_PACKAGE_RPI_FIRMWARE_VARIANT_PI4=y
BR2_PACKAGE_RPI_FIRMWARE_INSTALL_DTBS=n
BR2_PACKAGE_RPI_FIRMWARE_INSTALL_DTB_OVERLAYS=n
BR2_PACKAGE_RPI_BT_FIRMWARE=y
BR2_PACKAGE_RPI_WIFI_FIRMWARE=y

# Daemon to balance interrupts for SMP systems
BR2_PACKAGE_IRQBALANCE=y

# Daemon to use a Hardware TRNG
BR2_PACKAGE_RNG_TOOLS=y

# Secure Shell Server and Client
BR2_PACKAGE_OPENSSH=y

# Cryptography SSL/TLS Toolkit
BR2_PACKAGE_OPENSSL=y
BR2_PACKAGE_LIBOPENSSL=y
BR2_PACKAGE_LIBOPENSSL_BIN=y

# Certificate Authority Certificates
BR2_PACKAGE_CA_CERTIFICATES=y

# Asynchronous Resolver
BR2_PACKAGE_C_ARES=y

# XML/XSLT
BR2_PACKAGE_LIBXML2=y
BR2_PACKAGE_LIBXSLT=y

# Secure Shell Library
BR2_PACKAGE_LIBSSH2=y

# I18N Domain
BR2_PACKAGE_LIBIDN2=y

# Brotli
BR2_PACKAGE_BROTLI=y

# HTTP2
BR2_PACKAGE_NGHTTP2=y

# cURL
BR2_PACKAGE_LIBCURL=y
BR2_PACKAGE_LIBCURL_CURL=y
BR2_PACKAGE_LIBCURL_PROXY_SUPPORT=y
BR2_PACKAGE_LIBCURL_COOKIES_SUPPORT=y
BR2_PACKAGE_LIBCURL_EXTRA_PROTOCOLS_FEATURES=y

# Relay
BR2_PACKAGE_SOCAT=y

# Docker
BR2_PACKAGE_DOCKER_ENGINE=y
BR2_PACKAGE_DOCKER_CLI=y
BR2_PACKAGE_DOCKER_COMPOSE=y

# Mesa
BR2_PACKAGE_MESA3D=y
BR2_PACKAGE_MESA3D_DRIVER=y
BR2_PACKAGE_MESA3D_GALLIUM_DRIVER=y
BR2_PACKAGE_MESA3D_GALLIUM_DRIVER_V3D=y
BR2_PACKAGE_MESA3D_GALLIUM_DRIVER_VC4=y
BR2_PACKAGE_MESA3D_OPENGL_EGL=y
BR2_PACKAGE_MESA3D_OPENGL_ES=y

# Python
BR2_PACKAGE_PYTHON3=y
BR2_PACKAGE_PYTHON3_PY_PYC=y

# Kodi
BR2_PACKAGE_KODI=y
BR2_PACKAGE_KODI_ALSA_LIB=y
BR2_PACKAGE_KODI_AVAHI=y
BR2_PACKAGE_KODI_BLUEZ=y
BR2_PACKAGE_KODI_DBUS=y
BR2_PACKAGE_KODI_LIBCEC=y
BR2_PACKAGE_KODI_LIBMICROHTTPD=y
BR2_PACKAGE_KODI_UPNP=y

# Kodi Render system
BR2_PACKAGE_KODI_RENDER_SYSTEM_GLES=y

# Kodi PVR Addon
BR2_PACKAGE_KODI_PVR_IPTVSIMPLE=y

# ISDB-T
BR2_PACKAGE_CCID=y
BR2_PACKAGE_PCSC_LITE=y
BR2_PACKAGE_LIBARIB25=y
BR2_PACKAGE_RECDVB=y
BR2_PACKAGE_RECPT1=y
BR2_PACKAGE_MIRAKC_ARIB=y
BR2_PACKAGE_MIRAKC=y

# Debug
BR2_PACKAGE_STRACE=y

# Required tools to create the SD image
# BR2_PACKAGE_HOST_DOSFSTOOLS=y
# BR2_PACKAGE_HOST_GENIMAGE=y
# BR2_PACKAGE_HOST_MTOOLS=y
